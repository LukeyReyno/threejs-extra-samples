(()=>{"use strict";var e,t={424:function(e,t,n){var r,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),a=0;a<n.length;a++)"default"!==n[a]&&o(t,e,n[a]);return i(t,e),t}),s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const l=a(n(186)),d=n(246),c=n(351),u=new l.Clock,h="./textures/mono_equirect_test.png";let p,v,y,m,f,w,g,x,b,M,D,O,_=!1;const S=()=>s(void 0,void 0,void 0,(function*(){const e=f.xr.getSession();if(e&&e.renderState.layers){if(x&&(y.remove(x),x.geometry.dispose(),Array.isArray(x.material)?x.material.forEach((e=>e.dispose())):x.material.dispose(),x=null),!g){const e=new l.TextureLoader;g=yield e.loadAsync(h)}e.requestReferenceSpace("local-floor").then((t=>{b=f.xr.getBinding().createEquirectLayer({space:t,viewPixelWidth:g.image.width,viewPixelHeight:g.image.height,textureType:"texture",layout:"mono"});const n=e.renderState.layers||[],r=[b,...n];console.log("New layers:",r),null==e||e.updateRenderState({layers:r})}))}})),j=()=>{_=!0},P=()=>{v.aspect=window.innerWidth/window.innerHeight,v.updateProjectionMatrix(),f.setSize(window.innerWidth,window.innerHeight)},E=(e,t)=>{const n=60*u.getDelta();if(_&&(S(),_=!1),b&&b.needsRedraw){let e=f.xr.getBinding().getSubImage(b,t),n=f.getContext();n.bindTexture(n.TEXTURE_2D,e.colorTexture),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,g.image),n.bindTexture(n.TEXTURE_2D,null)}m.setFromXRController(M);const r=m.intersectObjects(w.children,!1);r.length>0?O!=r[0].object&&(O&&O.material.emissive.setHex(O.currentHex),O=r[0].object,O.currentHex=O.material.emissive.getHex(),O.material.emissive.setHex(16711680)):(O&&O.material.emissive.setHex(O.currentHex),O=void 0);for(let e=0;e<w.children.length;e++){const t=w.children[e];t.userData.velocity.multiplyScalar(1-.001*n),t.position.add(t.userData.velocity);const r=.5;(t.position.x<-r||t.position.x>r)&&(t.position.x=l.MathUtils.clamp(t.position.x,-r,r),t.userData.velocity.x=-t.userData.velocity.x),(t.position.y<0||t.position.y>1)&&(t.position.y=l.MathUtils.clamp(t.position.y,0,1),t.userData.velocity.y=-t.userData.velocity.y),(t.position.z<-r||t.position.z>r)&&(t.position.z=l.MathUtils.clamp(t.position.z,-r,r),t.userData.velocity.z=-t.userData.velocity.z),t.rotation.x+=2*t.userData.velocity.x*n,t.rotation.y+=2*t.userData.velocity.y*n,t.rotation.z+=2*t.userData.velocity.z*n}f.render(y,v)};(()=>{p=document.createElement("div"),document.body.appendChild(p),y=new l.Scene,y.background=new l.Color(24720),v=new l.PerspectiveCamera(50,window.innerWidth/window.innerHeight,.1,2e3),v.position.set(0,1.6,3),y.add(v),w=new l.Object3D,y.add(w),y.add(new l.HemisphereLight(10855845,9013641,3));const e=new l.DirectionalLight(16777215,3);e.position.set(1,1,1).normalize(),y.add(e);const t=new l.BoxGeometry(.15,.15,.15);for(let e=0;e<20;e++){const e=new l.Mesh(t,new l.MeshLambertMaterial({color:16777215*Math.random()}));e.position.x=4*Math.random()-2,e.position.y=4*Math.random(),e.position.z=4*Math.random()-2,e.rotation.x=2*Math.random()*Math.PI,e.rotation.y=2*Math.random()*Math.PI,e.rotation.z=2*Math.random()*Math.PI,e.scale.x=Math.random()+.5,e.scale.y=Math.random()+.5,e.scale.z=Math.random()+.5,e.userData.velocity=new l.Vector3,e.userData.velocity.x=.01*Math.random()-.005,e.userData.velocity.y=.01*Math.random()-.005,e.userData.velocity.z=.01*Math.random()-.005,w.add(e)}s(void 0,void 0,void 0,(function*(){const e=new l.TextureLoader;g=yield e.loadAsync(h);const t=new l.SphereGeometry(1e3),n=new l.MeshBasicMaterial({map:g,side:l.BackSide});x=new l.Mesh(t,n),y.add(x)})),m=new l.Raycaster,f=new l.WebGLRenderer({antialias:!0}),f.setPixelRatio(window.devicePixelRatio),f.setSize(window.innerWidth,window.innerHeight),f.setAnimationLoop(E),f.autoClearColor=!1,f.xr.enabled=!0,f.xr.addEventListener("sessionstart",j),p.appendChild(f.domElement),M=f.xr.getController(0);M.addEventListener("selectstart",(()=>{M.userData.isSelecting=!0})),M.addEventListener("selectend",(()=>{M.userData.isSelecting=!1})),M.addEventListener("connected",(e=>{const t=(e=>{let t,n;switch(e.targetRayMode){case"tracked-pointer":return t=new l.BufferGeometry,t.setAttribute("position",new l.Float32BufferAttribute([0,0,0,0,0,-1],3)),t.setAttribute("color",new l.Float32BufferAttribute([.5,.5,.5,0,0,0],3)),n=new l.LineBasicMaterial({vertexColors:!0,blending:l.AdditiveBlending}),new l.Line(t,n);case"gaze":return t=new l.RingGeometry(.02,.04,32).translate(0,0,-1),n=new l.MeshBasicMaterial({opacity:.5,transparent:!0}),new l.Mesh(t,n)}})(e.data);t&&M.add(t)})),M.addEventListener("disconnected",(()=>{M.remove(M.children[0])})),y.add(M);const n=new c.XRControllerModelFactory;D=f.xr.getControllerGrip(0),D.add(n.createControllerModel(D)),y.add(D),window.addEventListener("resize",P),document.body.appendChild(d.VRButton.createButton(f,{optionalFeatures:[]}))})()}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,r),i.exports}r.m=t,e=[],r.O=(t,n,o,i)=>{if(!n){var a=1/0;for(c=0;c<e.length;c++){for(var[n,o,i]=e[c],s=!0,l=0;l<n.length;l++)(!1&i||a>=i)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(s=!1,i<a&&(a=i));if(s){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[n,o,i]},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={766:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[a,s,l]=n,d=0;if(a.some((t=>0!==e[t]))){for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(l)var c=l(r)}for(t&&t(n);d<a.length;d++)i=a[d],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(c)},n=self.webpackChunkthreejs_extra_samples=self.webpackChunkthreejs_extra_samples||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=r.O(void 0,[612,343],(()=>r(424)));o=r.O(o)})();